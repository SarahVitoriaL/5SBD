Tabela Compra

INSERT INTO `5sdb`.`compra` (`codigoComprador`, `codigoPedido`, `dataPedido`, `valorCompra`, `fretePedido`)
SELECT `codigoComprador`, `codigoPedido`, `dataPedido`, SUM(`valor`) AS valorCompra, SUM(`frete`)
FROM `5sdb`.`tempdata`
GROUP BY `codigoPedido`;

Tabela Estoque

Tabela Entrega

INSERT INTO `5sdb`.`entrega` (`codigoPedido`, `valor`)
SELECT `codigoPedido`, `qtd` * `valorPedido` AS valor
FROM `5sdb`.`pedido`
ORDER BY `valor`DESC;
